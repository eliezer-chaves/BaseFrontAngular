<div class="auth-card">
    <h1 class="text-center">{{'domain.auth.pages.forgotPassword.Title' | transloco}}</h1>
    <h2 class="text-center mt-2">{{'domain.auth.pages.forgotPassword.subTitle' | transloco}}</h2>
    <form nz-form [nzLayout]="'vertical'" [formGroup]="validateForm" (ngSubmit)="submitForm()" class="mt-2">
        <nz-form-item>
            <nz-form-label class="custom-label">{{'domain.auth.pages.login.labelEmail' | transloco}}</nz-form-label>
            <nz-form-control [nzErrorTip]="emailErrorTpl">
                <input nz-input formControlName="usr_email"
                    placeholder="{{'domain.auth.pages.login.placeholderEmail' | transloco}}" />
                <ng-template #emailErrorTpl let-control>
                    {{ control.errors?.['required'] ? ('domain.auth.pages.login.errorEmailRequired' | transloco) : '' }}
                    {{ control.errors?.['email'] ? ('domain.auth.pages.login.errorEmailInvalid' | transloco) : '' }}
                </ng-template>
            </nz-form-control>
        </nz-form-item>

        <nz-form-item class="mt-3">
            <nz-form-control>
                <button nz-button nzType="primary" nzBlock [nzLoading]="isLoading"
                    [disabled]="!validateForm.valid || isLoading || isBlocked">
                    @if (isBlocked) {
                    {{'domain.auth.pages.forgotPassword.buttonWait' | transloco}} {{ getFormattedTime() }}
                    } @else {
                    {{'domain.auth.pages.forgotPassword.buttonSendCode' | transloco}}
                    }
                </button>

                @if (!isBlocked && attemptsRemaining === 1) { 
                    <div class="rate-limit-info last-attempt">
                        <span nz-icon nzType="warning" nzTheme="outline"></span>
                        {{'domain.auth.pages.forgotPassword.lastAttempt' | transloco}} 
                    </div>
                } @else if (!isBlocked && attemptsRemaining > 1 && attemptsRemaining < maxAttempts) { 
                    <div class="rate-limit-info">
                        <span nz-icon nzType="info-circle" nzTheme="outline"></span>
                        {{'domain.auth.pages.forgotPassword.attemptsRemaining' | transloco: { remaining: attemptsRemaining,
                        max: maxAttempts } }}
                    </div>
                }
            </nz-form-control>
        </nz-form-item>
    <div class="text-start text-link mt-2">
        <a routerLink="/auth/login">
            <nz-icon nzType="arrow-left" nzTheme="outline" />
            {{'domain.auth.pages.forgotPassword.linkGoBackLogin' | transloco}}
        </a>
    </div>


</form>
<nz-divider></nz-divider>
<div style="display: flex; align-items: center; justify-content: space-between;">

    <app-button-language></app-button-language>
    <app-button-theme></app-button-theme>
</div>
</div>